{"componentChunkName":"component---src-templates-notes-js","path":"/networking/http","result":{"data":{"markdownRemark":{"html":"<h2>URI</h2>\n<p>HTTP relies on the Uniform Resource Identifier (URI) standard for requesting target resource. A URI can be classified as a locator(URL), a name(URN), or both.</p>\n<p>In addition to identify the resource, URL also specify the location of the resource by specifying the access mechanism (e.g. network location)</p>\n<p>Example</p>\n<ul>\n<li>URL: <em><a href=\"http://www.ietf.org/rfc/rfc2396.txt\">http://www.ietf.org/rfc/rfc2396.txt</a></em></li>\n<li>URN: <em>urn:oasis:names:specification:docbook:dtd:xml:4.1.2</em></li>\n</ul>\n<p><img src=\"img/uri-url-urn.png\" alt=\"URI, URL and URN\"></p>\n<p>See:</p>\n<ul>\n<li><a href=\"https://tools.ietf.org/html/rfc3986\">RFC-3986 URI</a></li>\n</ul>\n<h2>Messaging</h2>\n<h3>Client request</h3>\n<p><img src=\"img/http-request.png\" alt=\"Sample Request\">\nStatus line format</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">request-method resource-URI http-versions</code></pre></div>\n<p>header format</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">header-name: val1, val2, ...</code></pre></div>\n<h3>Server response</h3>\n<p><img src=\"img/http-response.png\" alt=\"Sample Response\"></p>\n<h2>HTTP methods</h2>\n<h3>OPTIONS</h3>\n<h3>GET</h3>\n<h4>Conditional GET semantics</h4>\n<p>When request messages include the applicable headers, the semantics of GET method changes to a 'conditional GET':</p>\n<ul>\n<li>If-Modified-Since</li>\n<li>If-Unmodified-Since</li>\n<li>If-Match</li>\n<li>If-None-Match</li>\n<li>If-Range\nThe GET will only be performed if the conditions are met. This is used to reduce network usage.</li>\n</ul>\n<h4>Partial GET semantics</h4>\n<h4>Cachablity</h4>\n<h2>Common HTTP headers</h2>\n<h3>Cache-Control</h3>\n<p>holds instructions for caching in both request and response.</p>\n<h4>Directives</h4>\n<p>Cacheability</p>\n<ul>\n<li><strong><code class=\"language-text\">public</code></strong>: resposne may be cached by any cache</li>\n<li><strong><code class=\"language-text\">private</code></strong>: the response is for a single user and should not be cached in a shared cache. A private cache may store the response.</li>\n<li><strong><code class=\"language-text\">no-cache</code></strong>: caches must re-validate with origin server before using the cached copy. (importhat to note that no-cache DOES NOT mean do not cache anything)</li>\n<li><strong><code class=\"language-text\">no-store</code></strong>: the cache should not store anything about the request or response.\nExpiration</li>\n<li><strong><code class=\"language-text\">max-age=\\&lt;seconds\\&gt;</code></strong>: The maximum amount of time a resource is considered fresh. This is relative to the time of the request (unlike the <code class=\"language-text\">Expires</code> header which uses absolute date time).</li>\n<li><strong><code class=\"language-text\">s-maxage=\\&lt;seconds\\&gt;</code></strong>: overrides the <code class=\"language-text\">max-age</code> or the <code class=\"language-text\">Expires</code> header for sshared caches. Ignored by private caches.</li>\n<li><strong><code class=\"language-text\">max-stale[=\\&lt;seconds\\&gt;]</code></strong>: indicates the client will accept a stale response. Optional value indicates the maximum staleness that client can accept.</li>\n<li><strong><code class=\"language-text\">min-fresh=\\&lt;seconds\\&gt;</code></strong>: Indicates the client wants a response that will still be fresh for at least the specified number of seconds.</li>\n<li><strong><code class=\"language-text\">no-transform</code></strong>:</li>\n<li><strong><code class=\"language-text\">only-if-cached</code></strong>:</li>\n</ul>\n<p>some other</p>\n<ul>\n<li><code class=\"language-text\">must-revalidate</code></li>\n<li><code class=\"language-text\">no-transform</code></li>\n<li><code class=\"language-text\">proxy-revalidate</code></li>\n<li>...</li>\n</ul>\n<h3>Accept</h3>\n<h3>Accept-Language</h3>\n<h3>Host</h3>\n<h3>If-Modified-Since</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">If-Modified-Since: &lt;http-date&gt;</code></pre></div>\n<p>Makes the request conditional:</p>\n<ul>\n<li>Server will send <code class=\"language-text\">200</code> response with requested resource, only if it has been last modified after the given date.</li>\n<li>Otherwise, sever send <code class=\"language-text\">304</code> response without any body;</li>\n</ul>\n<p>The date value comes from the <code class=\"language-text\">Last-Modified</code> response header of a previous request.</p>\n<h3>ETag</h3>\n<p>ETag response header is an identifier for a specific version of a resource.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ETag: W/&quot;&lt;etag_value&gt;&quot;\nETag: &quot;&lt;etag_value&gt;&quot;</code></pre></div>\n<p><code class=\"language-text\">W/</code> indicates using a weak validator. The etag value is generated by the server to uniquely represent the resource. It's usually a hash of the content.</p>\n<p>Etag is used to validate cached response with server.</p>\n<h3>Referer</h3>\n<p><code class=\"language-text\">Referer: &lt;url&gt;</code> indicates the previous web page linking to current page. Can be used in analytics to identify where user are visiting from.</p>\n<h3>Connection</h3>\n<p>Controls whether or not the network connection stays open after the current trasaction finishes. If the value send is <code class=\"language-text\">keep-alive</code>, the connection is persistent, allowing subsequent requests.</p>\n<p>Can be used together with the <code class=\"language-text\">Keep-Alive</code> header</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Connection: keep-alive\nKeep-Alive: timeout=5, max=1000</code></pre></div>\n<blockquote>\n<p>Connection-specifit headers MUST NOT be used in HTTP/2</p>\n</blockquote>\n<h2>Status codes</h2>\n<h3>3XX Redirection Messages</h3>\n<p>This class of status code indicates that further action needs to be taken by the <strong>user agent</strong> in order to fufill the request. The action required MAY be carried out by the user agent without interaction with the user if and only if the method used <strong>in the second request</strong> is GET or HEAD.</p>\n<nav class=\"no-bullet\">\n<p><strong>301 Moved Permanently</strong></p>\n<ul>\n<li>Indicates that the URI of the requested resource has been changed permanently. Any future references to this resource should use the new permanent URI. The new permanent URI should be given in the Location field in response.</li>\n</ul>\n<p><strong>302 Found</strong></p>\n<ul>\n<li>Indicates that the URI of the requested resource has been changed <em>temporarily</em>.</li>\n</ul>\n<p><strong>307 Temporary Redirect</strong></p>\n<ul>\n<li>Same semantics as <code class=\"language-text\">302 Found</code>, except that the user agent must not change the HTTP method used in the following requests.</li>\n</ul>\n<p><strong>308 Permanent Redirect</strong></p>\n<ul>\n<li>\n<p>Same semantics as <code class=\"language-text\">301 Moved</code>, except that the user agent must not change the HTTP method used in the following requests.</p>\n</nav>\n</li>\n</ul>\n<h2>HTTP 1.1 over HTTP 1.0</h2>\n<h3>Caching</h3>\n<h3>Persistent Connection</h3>\n<h1>HTTPS</h1>\n<h2>SSL</h2>\n<p>SSL was the previous protocol, including SSL1.0, 2.0 and 3.0. Now deprecated and insecure.</p>\n<h2>Transport Layer Security (TLS)</h2>\n<p>Built on top of SSL 3.0</p>\n<h3>TLS Handshake</h3>\n<p>On top of the normal 3-way TCP handshake, additional information is needed to negotiate the encrypted tunnel. Client and server need to agree on the version of TLS protocol, the ciphersuite and verify certificate etc.</p>\n<p>TLS handshake added more round trip times (below is just for example):</p>\n<ol>\n<li>S: SYN</li>\n<li>R: SYN ACK</li>\n<li>S: SYN + ClientHello</li>\n<li>R: ServerHello + Certificate + ServerHelloDone</li>\n<li>S: ClientKeyExchange + ChangeCipherSpec + Finished</li>\n<li>R: ChangeCipherSpec + Finished</li>\n<li>(secure tunnel established...)\n(S - Sender, R - Receiver)</li>\n</ol>\n<h2>Asymmetric encryption + Symmetric encryption</h2>\n<p>The reason why we need to use a combination of asymmetric and symmetric is that, <strong>asymmetric encryption are often slow and not used for encrpyting large amount of data</strong>. So we still use the symmetric key to encrypt the message, but on top of that, we use asymmetric encryption to encrypt the symmetric key.</p>\n<h2>Digital Certificate</h2>\n<h3>X.509</h3>\n<p>In cryptography, X.509 is the standard defining the format of <strong>public key certificate</strong>. X.509 is used in TLS/SSL, which is the basis for HTTPS. They can also be used for offline applications such as electronic signatures.</p>\n<p>The reason we need certificate is that we can <strong>make sure that the public key is from the trusted source</strong>.</p>\n<h3>Certificate path validation algorithm</h3>\n<p>X.509 defines a certificate path validation alogrithm, which allows a certificate to be signed by intermediate CA certificates, which are, in turn, signed by other certificate, eventually reaching a <strong>trust anchor</strong>.</p>\n<p>The alogrithm can verify a given certificate path from the subject certificate leading up to a trusted root certificate.</p>\n<h1>HTTP/2</h1>\n<h2>Byte framing layer</h2>\n<p>*This is the foundational design change for http/2 over http/1.x</p>\n<p>HTTP/2 introduced a new optimized binary ecoding mechanism. The logical content of http message is not affected (verb, headers, etc). A message is encoded into one or more frames. Each frame contains frame header to identify the stream which it belongs to.</p>\n<ul>\n<li>Stream: a bidirectional flow of bytes within an established connection, which may carray one or more messages.</li>\n</ul>\n<p>Byte framing is the fundation that enables all other features and performance optimizations.</p>\n<h2>Multiplexing</h2>\n<p>For HTTP/2 all communications is performed over a single TCP connection (<strong>per origin</strong>). As a result of using byte framing layer, client/server breaks down a HTTP message into indenpendent frames, which can be interleaved, and later reassemble them on the recieving end.</p>\n<p>the ability to interleave and re-asseble frames provides multiple benefits:</p>\n<ul>\n<li>interleave multiple requests (or responses) without blocking any one</li>\n<li>deliver multiple requests in parallel</li>\n<li>improve utilization of available network</li>\n</ul>\n<h2>Stream prioritization</h2>\n<p>Http/2 allows each stream to have associated weight and explicit dependency on another stream. Client and construct and communicate a 'prioritization tree' to express how it would prefer to receive responses. In turn server can use the info to prioritize resources.</p>\n<p>Note this is an expression of preference, it doesn't gurantee the processing and transmission.</p>\n<h2>One connection per origin</h2>\n<p>With the binary framing mechanism enalbing multiplexing, HTTP/2 connections are persistent and only one connection is required per origin.</p>\n<p>The benefits are obvious:</p>\n<ul>\n<li>reduce network latency by reducing the overhead of multiple TCP/TLS handshakes.</li>\n<li>increase throughput/network capacity, as intermediaries/servers handles fewer connections per client.</li>\n</ul>\n<h2>Flow control</h2>\n<p>HTTP/2 provide a mechanism to intialize and update the window size via SETTINGS / DATA / WINDOW_UPDATE frame.</p>\n<p>The implementation of flow control is leave to the client/server.</p>\n<h2>Server push</h2>\n<p>Server push allows server to send multiple response for a single request. This allows server to push additional resources to client without the client having to request explicitly.</p>\n<blockquote>\n<p>This mechanism opens up many opportunities, as it breaks free from the request-response model.</p>\n</blockquote>\n<h2>Header compression</h2>\n<h3>HPACK</h3>\n<h3>static / dynamic table</h3>","frontmatter":{"title":"HTTP"},"parent":{"__typename":"File","modifiedTime":"2021-10-26T14:41:02.019Z"}}},"pageContext":{}}}